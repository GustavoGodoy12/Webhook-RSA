odo o fluxo começa com o novo rsa_puro.js, que implementa RSA apenas com BigInt e o gerador de números aleatórios do próprio JavaScript: ele cria primos grandes por meio de Miller–Rabin probabilístico, gera o par de chaves calculando n = p·q, φ = (p-1)(q-1) e encontra d como inverso modular de e = 65537, além de disponibilizar funções de exponenciação modular rápida para cifrar/decifrar, assinar/verificar e utilitários que convertem texto em BigInt e vice-versa; tudo dispensa o módulo crypto, logo não há CSPRNG verdadeiro nem padding seguro, mas serve como prova de conceito. No chat_http.js, a aplicação Node cria um pequeno servidor Express que recebe POST / msg e, na inicialização, gera seu par de chaves com o RSA puro; a interface de linha de comando não bloqueia o event-loop porque usa readline assíncrono, de modo que o servidor continua atendendo requisições enquanto espera o usuário digitar. Assim que o programa inicia ele pergunta a URL do peer (que pode ser um túnel LocalTunnel tipo https://chatB.loca.lt) e começa a tentar o “handshake”: envia sua chave pública como JSON {e,n} a cada três segundos até receber a do outro lado; quando finalmente recebe a chave do peer, guarda-a num objeto e para de reenviar. A partir daí, cada linha digitada é convertida em BigInt, cifrada com a chave pública remota, assinada com a chave privada local, empacotada num JSON {c,s} e enviada via fetch ao peer; do lado que recebe, o servidor decifra com a chave privada, verifica a assinatura com a chave pública correspondente e exibe na console a mensagem original com um ✓ se a verificação foi bem-sucedida (ou ✗ caso contrário). Todo o tráfego ocorre sobre HTTP simples, mas a confidencialidade depende da cifra RSA aplicada a cada payload; se ambos os nós forem expostos pela internet através de lt --port <porta>, cada um recebe uma URL HTTPS pública, bastando colar a URL oposta no prompt para que a troca de chaves e as mensagens se propaguem pela web, sem bloqueios de I/O síncrono e sem recorrer a bibliotecas criptográficas nativas.
